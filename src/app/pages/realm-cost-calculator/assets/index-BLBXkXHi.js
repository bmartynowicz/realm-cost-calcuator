(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))t(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&t(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function t(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();const _e=new Set(["splunk-es","sumo-logic-siem","microsoft-sentinel","crowdstrike-next-gen-siem"]),ne=[{id:"aws-cloudtrail",label:"AWS - CloudTrail",description:"Account activity events captured across AWS services.",costPerMillionEvents:18,realmOptimization:.35,trafficCategory:"cloud-infrastructure"},{id:"aws-alb-logs",label:"AWS - ALB logs",description:"Application Load Balancer access logs for web traffic analysis.",costPerMillionEvents:16,realmOptimization:.28,trafficCategory:"network-security"},{id:"aws-vpc-flow-logs",label:"AWS - VPC Flow Logs",description:"Network flow records exported from VPC subnets and interfaces.",costPerMillionEvents:14,realmOptimization:.27,trafficCategory:"network-security"},{id:"crowdstrike-falcon",label:"Crowdstrike Falcon",description:"EDR detections, managed threat hunting, and audit events.",costPerMillionEvents:28,realmOptimization:.4,trafficCategory:"endpoint-edr"},{id:"palo-alto-networks-ngfw",label:"Palo Alto Networks - PanOS",description:"Threat, traffic, and URL filtering logs from PAN-OS.",costPerMillionEvents:27,realmOptimization:.6,trafficCategory:"network-security"},{id:"fortinet-fortigate",label:"Fortinet - Fortigate",description:"Unified threat management events from FortiGate appliances.",costPerMillionEvents:23,realmOptimization:.75,trafficCategory:"network-security"},{id:"cisco-umbrella",label:"Cisco Umbrella",description:"DNS-layer security and secure web gateway telemetry.",costPerMillionEvents:20,realmOptimization:.44,trafficCategory:"network-security"},{id:"infoblox-bloxone-ddi",label:"InfoBlox",description:"DNS, DHCP, and IP address management telemetry from BloxOne DDI.",costPerMillionEvents:20,realmOptimization:.71,trafficCategory:"network-security"},{id:"zscaler-internet-access",label:"Zscaler - ZIA",description:"Cloud proxy transactions and threat protection data.",costPerMillionEvents:22,realmOptimization:.34,trafficCategory:"network-security"},{id:"cloudflare-waf",label:"CloudFlare - WAF",description:"Web application firewall events and edge threat intelligence.",costPerMillionEvents:18,realmOptimization:.3,trafficCategory:"network-security"},{id:"okta",label:"Okta",description:"Identity provider system logs and authentication events.",costPerMillionEvents:23,realmOptimization:.38,trafficCategory:"identity"},{id:"google-cloud-audit-logs",label:"Google Cloud - Audit Logs",description:"Admin activity, data access, and system event logging.",costPerMillionEvents:18,realmOptimization:.32,trafficCategory:"cloud-infrastructure"},{id:"azure-monitor",label:"Azure Monitor",description:"Platform activity and diagnostic logs collected via Azure Monitor.",costPerMillionEvents:17,realmOptimization:.3,trafficCategory:"cloud-infrastructure"},{id:"microsoft-defender-endpoint",label:"Microsoft - Defender",description:"Behavioral detections and device telemetry from Defender.",costPerMillionEvents:26,realmOptimization:.38,trafficCategory:"endpoint-edr"},{id:"cisco-secure-firewall",label:"Cisco Secure Firewall (f.k.a. Firepower)",description:"Firewall, intrusion, and malware detection telemetry.",costPerMillionEvents:25,realmOptimization:.35,trafficCategory:"network-security"},{id:"sonicwall-capture-security",label:"SonicWall - SonicOS/X",description:"Firewall and advanced threat protection analytics.",costPerMillionEvents:16,realmOptimization:.25,trafficCategory:"network-security"},{id:"windows-event-logs",label:"Windows Event Logs",description:"Security, system, and application channel events from Windows hosts.",costPerMillionEvents:19,realmOptimization:.42,trafficCategory:"endpoint-edr"},{id:"akamai-security-events",label:"Akamai",description:"Edge security events from Akamai WAF and bot management services.",costPerMillionEvents:21,realmOptimization:.31,trafficCategory:"network-security"},{id:"microsoft-entra-id",label:"Microsoft - Entra ID",description:"Sign-in and audit events from Entra ID tenants.",costPerMillionEvents:19,realmOptimization:.33,trafficCategory:"identity"}],Be=[{id:"splunk-es",label:"Splunk Enterprise Security",description:"SIEM ingest licensing for Splunk Enterprise Security.",costPerMillionEvents:32,realmOptimization:.36},{id:"microsoft-sentinel",label:"Microsoft Sentinel",description:"Azure-native SIEM with pay-as-you-go log analytics ingestion.",costPerMillionEvents:27,realmOptimization:.34},{id:"crowdstrike-next-gen-siem",label:"CrowdStrike Falcon Next-Gen SIEM",description:"CrowdStrike-managed SIEM/XDR service built on Falcon LogScale with automated response.",costPerMillionEvents:28,realmOptimization:.35},{id:"ibm-qradar",label:"IBM Security QRadar",description:"Event processor capacity sized for mid-market deployments.",costPerMillionEvents:29,realmOptimization:.33},{id:"sumo-logic-siem",label:"Sumo Logic Cloud SIEM",description:"Cloud-native SIEM with continuous analytics ingest tier.",costPerMillionEvents:24,realmOptimization:.31},{id:"google-chronicle",label:"Google Chronicle Security Operations",description:"Planet-scale SIEM with built-in threat intelligence enrichment.",costPerMillionEvents:26,realmOptimization:.35},{id:"exabeam-fusion-siem",label:"Exabeam Fusion SIEM",description:"Behavioral analytics-driven SIEM with UEBA correlation.",costPerMillionEvents:25,realmOptimization:.34},{id:"rapid7-insightidr",label:"Rapid7 InsightIDR",description:"Cloud SIEM with integrated threat detection and response.",costPerMillionEvents:24,realmOptimization:.33},{id:"elastic-security-siem",label:"Elastic Security SIEM",description:"Elastic Stack-based SIEM with detection rules and cases.",costPerMillionEvents:22,realmOptimization:.32},{id:"logrhythm-nextgen",label:"LogRhythm NextGen SIEM",description:"Analytics-centric SIEM and SOAR platform.",costPerMillionEvents:25,realmOptimization:.33},{id:"arcsight-esm",label:"ArcSight Enterprise Security Manager",description:"Micro Focus ArcSight correlation and compliance platform.",costPerMillionEvents:30,realmOptimization:.34},{id:"fortinet-fortisiem",label:"Fortinet FortiSIEM",description:"Hybrid SIEM with integrated performance and security monitoring.",costPerMillionEvents:23,realmOptimization:.31},{id:"rsa-netwitness",label:"RSA NetWitness Platform",description:"Network and endpoint-focused SIEM with threat hunting.",costPerMillionEvents:28,realmOptimization:.34},{id:"att-cybersecurity-usm",label:"AT&T Cybersecurity USM Anywhere",description:"Cloud SIEM with integrated asset discovery and orchestration.",costPerMillionEvents:22,realmOptimization:.3},{id:"securonix-next-gen",label:"Securonix Next-Gen SIEM",description:"Cloud-native SIEM with UEBA and threat content subscriptions.",costPerMillionEvents:27,realmOptimization:.36},{id:"devo-security-operations",label:"Devo Security Operations",description:"High-volume cloud SIEM with real-time analytics.",costPerMillionEvents:25,realmOptimization:.35},{id:"graylog-security-enterprise",label:"Graylog Security Enterprise",description:"Log analytics and SIEM tailored for modern security teams.",costPerMillionEvents:21,realmOptimization:.3},{id:"hunters-soc-platform",label:"Hunters SOC Platform",description:"Cloud-native SIEM with autonomous detection engineering.",costPerMillionEvents:23,realmOptimization:.33},{id:"blumira-siem",label:"Blumira Automated SIEM",description:"Managed SIEM delivering automated detection and response.",costPerMillionEvents:20,realmOptimization:.29},{id:"logpoint-siem",label:"LogPoint SIEM",description:"European-built SIEM with UEBA and SOAR modules.",costPerMillionEvents:22,realmOptimization:.31},{id:"netsurion-eventtracker",label:"Netsurion EventTracker",description:"Co-managed SIEM for distributed enterprises and MSPs.",costPerMillionEvents:21,realmOptimization:.3}],Se=Be.filter(e=>_e.has(e.id)),Ue=1024*1024,he=[{id:"under-1000-gb",label:"Less than 1,000 employees",optionLabel:"Less than 1,000 employees",shortLabel:"Less than 1,000 employees",defaultDailyGigabytes:750,description:"Ideal for smaller teams where log pipelines rarely exceed a terabyte per day."},{id:"1000-5000-gb",label:"1,000 - 5,000 employees",optionLabel:"1,000 - 5,000 employees",shortLabel:"1,000 - 5,000 employees",defaultDailyGigabytes:3e3,description:"Best fit for mid-size estates that typically ingest one to five terabytes daily."},{id:"over-5000-gb",label:"5,000+ employees",optionLabel:"5,000+ employees",shortLabel:"5,000+ employees",defaultDailyGigabytes:6500,description:"Use this for large enterprises where daily log volume usually tops five terabytes."}],Ke=new Map(he.map(e=>[e.id,e])),oe="identity",pe={identity:"Identity and workforce access telemetry","cloud-infrastructure":"Cloud platform control-plane and audit activity","network-security":"Network flow, firewall, and secure service edge telemetry","endpoint-edr":"Endpoint detection and response telemetry","saas-business":"SaaS application and collaboration activity"},fe={identity:{"under-1000-gb":{averageEventSizeKb:1.2},"1000-5000-gb":{averageEventSizeKb:1.3},"over-5000-gb":{averageEventSizeKb:1.3}},"cloud-infrastructure":{"under-1000-gb":{averageEventSizeKb:1.6},"1000-5000-gb":{averageEventSizeKb:1.7},"over-5000-gb":{averageEventSizeKb:1.8}},"network-security":{"under-1000-gb":{averageEventSizeKb:.12},"1000-5000-gb":{averageEventSizeKb:.13},"over-5000-gb":{averageEventSizeKb:.14}},"endpoint-edr":{"under-1000-gb":{averageEventSizeKb:3.5},"1000-5000-gb":{averageEventSizeKb:3.8},"over-5000-gb":{averageEventSizeKb:4}},"saas-business":{"under-1000-gb":{averageEventSizeKb:1.5},"1000-5000-gb":{averageEventSizeKb:1.6},"over-5000-gb":{averageEventSizeKb:1.7}}},we=he,Ge=e=>{const i=Ke.get(e);if(!i)throw new Error(`Unknown organization size key: ${e}`);return i},We=(e,i)=>{const t=(fe[e]??fe[oe])[i];if(!t)throw new Error(`Missing baseline for category ${e} and size ${i}`);return t},Me=(e,i)=>{const n=Ge(i),t=e.trafficCategory??oe,o=We(t,i),r=n.defaultDailyGigabytes,a=o.averageEventSizeKb,c=Math.round(r*Ue/Math.max(a,1e-4));return{organizationSize:n,category:t,dailyEvents:c,dailyGigabytes:r,averageEventSizeKb:a}},re=e=>{const{organizationSize:i,category:n,dailyEvents:t,averageEventSizeKb:o,dailyGigabytes:r}=e,a=pe[n]??pe[oe],c=r/1024,u=r>=1024?`${c.toLocaleString(void 0,{maximumFractionDigits:2})} TB`:`${r.toLocaleString(void 0,{maximumFractionDigits:r>=100?0:1})} GB`;return[`${a} baseline for ${i.shortLabel.toLowerCase()}:`,`Approximately ${u} per day (~${t.toLocaleString()} events at ${o.toFixed(1)} KB per event).`].join(" ")},ae=7.5,je=30,se=1024*1024,He=se*1024,Ve=1,Ze=.75,B=12,Xe=.18,Ye=12;var Ee;(Ee=document.querySelector('[data-role="cribl-comparison"]'))==null||Ee.remove();const Qe="Download executive summary PDF",Je="Export unavailable - try again";let X=null;const et=async()=>{var i;if(typeof window>"u")return null;const e=window;return(i=e.jspdf)!=null&&i.jsPDF?e.jspdf.jsPDF:(X||(X=new Promise(n=>{const t=document.createElement("script");t.src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js",t.async=!0,t.crossOrigin="anonymous",t.onload=()=>{var r;const o=((r=window.jspdf)==null?void 0:r.jsPDF)??null;n(o)},t.onerror=()=>n(null),document.head.appendChild(t)})),X)},tt="Realm-Security-Logo.png";let P;const it=async()=>{if(P!==void 0)return P;if(typeof window>"u"||typeof document>"u")return P=null,P;try{const e=await fetch(tt,{cache:"force-cache"});if(!e.ok)throw new Error(`Realm logo request failed with status ${e.status}`);const i=await e.blob(),n=URL.createObjectURL(i);P=await new Promise((o,r)=>{const a=new Image;a.onload=()=>{try{const c=a.naturalWidth||256,u=a.naturalHeight||90,s=document.createElement("canvas");s.width=c,s.height=u;const l=s.getContext("2d");if(!l){r(new Error("Realm logo canvas context unavailable."));return}l.drawImage(a,0,0,c,u),o({dataUrl:s.toDataURL("image/png"),width:c,height:u})}catch(c){r(c)}finally{URL.revokeObjectURL(n)}},a.onerror=()=>{URL.revokeObjectURL(n),r(new Error("Realm logo image failed to load."))},a.src=n})}catch(e){console.error("Realm logo failed to load for PDF export:",e),P=null}return P},nt={"fortinet-fortigate::sumo-logic-siem":{averageOptimization:.2099,note:"Calibrated to Vensure case study (~$250K annual savings with Realm Focus)."}},m=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:e<100?2:0}).format(e),U=e=>new Intl.NumberFormat("en-US",{maximumFractionDigits:0}).format(e),Y=(e,{maximumFractionDigits:i=2,minimumFractionDigits:n}={})=>{const t=typeof n=="number"?n:e%1===0?0:Math.min(2,i);return new Intl.NumberFormat("en-US",{maximumFractionDigits:i,minimumFractionDigits:t}).format(e)},le=e=>{if(e.length===0)throw new Error("At least one source must be provided for calculation.");if(e.length===1){const[n]=e;return{costPerMillionEvents:n.costPerMillionEvents,realmOptimization:n.realmOptimization}}const i=e.reduce((n,t)=>(n.costPerMillionEvents+=t.costPerMillionEvents,n.realmOptimization+=t.realmOptimization,n),{costPerMillionEvents:0,realmOptimization:0});return{costPerMillionEvents:i.costPerMillionEvents/e.length,realmOptimization:i.realmOptimization/e.length}},ot=({sources:e,destination:i,dailyTraffic:n})=>{if(e.length===0)throw new Error("At least one source must be selected.");const t=n*je,o=t/1e6,r=le(e),a=r.costPerMillionEvents+i.costPerMillionEvents,c=a+B,u=o*c,s=e.length===1?`${e[0].id}::${i.id}`:null,l=s?nt[s]:void 0,p=(l==null?void 0:l.averageOptimization)??Math.min(Ze,(r.realmOptimization+i.realmOptimization)/2),M=a*(1-p),S=o*(M+ae),h=u-S,g=u>0?h/u*100:0;return{monthlyEvents:t,standardCost:u,realmCost:S,savings:h,savingsPercentage:g,providerRatePerMillion:a,legacyRatePerMillion:c,optimizedRatePerMillion:M,averageOptimization:p,calibrationNote:(l==null?void 0:l.note)??""}},rt=document.querySelector("#sourceSelect"),at=document.querySelector('[data-role="source-search"]'),st=document.querySelector("#destinationSelect"),lt=document.querySelector("#organizationSize"),ct=document.querySelector("#trafficInput"),dt=document.querySelector("#trafficUnit"),ut=document.querySelector("#eventSizeInput"),mt=document.querySelector('[data-role="event-size-field"]'),pt=document.querySelector("#sourceSummary"),ft=document.querySelector("#destinationSummary"),gt=document.querySelector("#trafficError"),vt=document.querySelector("#monthlyEvents"),yt=document.querySelector("#standardCost"),Et=document.querySelector("#realmCost"),bt=document.querySelector("#savings"),St=document.querySelector("#calibrationNote"),ht=document.querySelector("#trafficRecommendation"),wt=document.querySelector('[data-role="export-pdf-form"]'),Mt=document.querySelector("#exportCompanyInput"),xt=document.querySelector("#exportContactInput"),zt=document.querySelector("#exportEmailInput"),Pt=document.querySelector('[data-role="export-pdf-button"]'),f=(e,i)=>{if(e===null)throw new Error(`${i} element was not found in the document`);return e},x=f(rt,"Source select"),C=f(st,"Destination select"),F=f(lt,"Organization size select"),b=f(ct,"Traffic input"),H=f(dt,"Traffic unit select"),y=at??null,z=ut??null,Q=mt??null,Ct=f(pt,"Source summary"),q=f(ft,"Destination summary"),_=f(gt,"Traffic error"),xe=f(vt,"Monthly events"),ze=f(yt,"Current cost"),Pe=f(Et,"Realm cost"),Ce=f(bt,"Savings"),$=f(ht,"Traffic recommendation"),ge=f(wt,"Export PDF form"),ee=f(Mt,"Export company input"),te=f(xt,"Export contact input"),ie=f(zt,"Export email input"),d=f(Pt,"Export PDF button"),L=St??null,ve=[ee,te,ie];let Le=[],K=!1,D=!1,A=null;const Oe=e=>e.normalize("NFKD").replace(/[\u0300-\u036f]/gu,"").toLowerCase(),Lt=()=>{Le=Array.from(x.options).map(e=>{const i=ne.find(t=>t.id===e.value),n=Oe(`${e.textContent??""} ${(i==null?void 0:i.description)??""}`);return{option:e,tokens:n}})},G=e=>{const i=Oe(e.trim()),n=i.length>0;for(const t of Le){const r=!n||t.tokens.includes(i)||t.option.selected;t.option.hidden=!r}n&&(x.scrollTop=0)},Ie=new Map;document.querySelectorAll('[data-role="tooltip-text"]').forEach(e=>{e.id&&Ie.set(e.id,e)});const Ae=new Map;document.querySelectorAll('[data-role="tooltip-trigger"]').forEach(e=>{var o;const i=e.dataset.tooltipTarget;if(!i)return;Ae.set(i,e);const n=(o=e.dataset.tooltipLabel)==null?void 0:o.trim();n&&e.setAttribute("aria-label",n),e.hasAttribute("aria-expanded")||e.setAttribute("aria-expanded","false");const t=r=>{e.setAttribute("aria-expanded",r?"true":"false")};e.addEventListener("mouseenter",()=>t(!0)),e.addEventListener("mouseleave",()=>t(!1)),e.addEventListener("focus",()=>t(!0)),e.addEventListener("blur",()=>t(!1)),e.addEventListener("keydown",r=>{r.key==="Escape"&&(t(!1),e.blur())})});const R=(e,i)=>{var r,a;const n=i.trim(),t=Ie.get(e);t&&(t.textContent=n);const o=Ae.get(e);if(o)if(n){o.hidden=!1,o.dataset.tooltip=n,o.setAttribute("title",n);const c=(r=o.dataset.tooltipLabel)==null?void 0:r.trim();c?o.setAttribute("aria-label",`${c}: ${n}`):o.setAttribute("aria-label",n)}else{o.hidden=!0,delete o.dataset.tooltip,o.removeAttribute("title");const c=(a=o.dataset.tooltipLabel)==null?void 0:a.trim();c?o.setAttribute("aria-label",c):o.removeAttribute("aria-label"),o.setAttribute("aria-expanded","false")}};let Ot=!1;var be;const Fe=((be=d.textContent)==null?void 0:be.trim())||Qe;d.textContent=Fe;const W=()=>{d.textContent=Fe,d.classList.remove("metrics__export-button--error"),d.removeAttribute("data-error")},It=e=>{d.textContent=e,d.classList.add("metrics__export-button--error"),d.setAttribute("data-error",e),window.setTimeout(()=>{W()},4e3)},ce=e=>{d.disabled=!e,e?(W(),d.removeAttribute("aria-disabled")):(d.setAttribute("aria-disabled","true"),W())};ce(!1);let j=null;const At=e=>{},Ft=(e,i)=>{if(e<=0)return 0;const n=e/1e6,o=(i+Ye)*(1+Xe);return n*o},ye=(e,i)=>{e.innerHTML="";for(const n of i){const t=document.createElement("option");t.value=n.id,t.textContent=n.label,e.appendChild(t)}},Rt=e=>{e.innerHTML="";for(const i of we){const n=document.createElement("option");n.value=i.id,n.textContent=i.optionLabel,n.title=i.description,e.appendChild(n)}},Re=(e,i)=>{const n=e.find(t=>t.id===i);if(!n)throw new Error(`Unknown endpoint id: ${i}`);return n},Te=(e,i)=>{e.textContent=`${i.description} - ${m(i.costPerMillionEvents)} per million events`},Tt=e=>{e.addEventListener("mousedown",i=>{const n=i.target;if(!(n instanceof HTMLOptionElement))return;i.preventDefault();const t=e.scrollTop;n.selected=!n.selected,e.dispatchEvent(new Event("change",{bubbles:!0})),window.requestAnimationFrame(()=>{e.scrollTop=t,n.hidden?e.focus():n.focus()})})},$t=()=>Array.from(x.selectedOptions).map(e=>e.value).filter(e=>e!==""),$e=()=>{const e=$t();return e.length===0?[]:e.map(i=>Re(ne,i))},Dt=(e,i)=>{if(i.length===0){e.textContent="Select at least one source.",e.removeAttribute("title");return}if(i.length===1){Te(e,i[0]),e.title=i[0].label;return}const n=le(i);e.textContent=`${i.length} sources selected â€¢ Avg provider rate ${m(n.costPerMillionEvents)} per million events`,e.title=i.map(t=>t.label).join(", ")},J=()=>{j=null,ce(!1),xe.textContent="--",ze.textContent="--",Pe.textContent="--",Ce.textContent="--",R("standardBreakdown",""),R("realmBreakdown",""),R("savingsPercent",""),L&&(L.textContent="",L.classList.add("field--hidden"))},V=({overrideTraffic:e,overrideEventSize:i}={})=>{const n=F.value,t=$e(),o=t[0]??null;if(!o){A=null,$.textContent="Select at least one source to view recommended traffic.";return}const r=Me(o,n);A=r;const a=H.value,c=e??(!K||b.value.trim()===""),u=z&&a!=="events"?i??(!D||z.value.trim()===""):!1;if(c){if(a==="events")b.value=Math.round(r.dailyEvents).toString();else if(a==="gigabytes"){const l=r.dailyGigabytes,p=l>=100?0:l>=10?1:2;b.value=Number(l.toFixed(p)).toString()}else{const l=r.dailyGigabytes/1024,p=l>=100?0:l>=10?1:2;b.value=Number(l.toFixed(p)).toString()}K=!1}u&&z&&(z.value=r.averageEventSizeKb.toFixed(1),D=!1);const s=re(r);$.textContent=t.length>1?`${s} (baseline uses ${o.label}; adjust for additional sources as needed.)`:s},O=()=>{const e=$e(),i=e[0]??null,n=C.value;Dt(Ct,e);let t=null;if(n?(t=Re(Se,n),Te(q,t),q.title=t.label):(q.textContent="Select a destination.",q.removeAttribute("title")),!i||!t){A=i?A:null,_.textContent="",i?$.textContent="Select a destination to calculate costs.":$.textContent="Select at least one source to view recommended traffic.",J();return}const o=F.value,r=A??Me(i,o);A=r;const a=re(r);$.textContent=e.length>1?`${a} (baseline uses ${i.label}; adjust for additional sources as needed.)`:a;const c=H.value,u=c==="events";Q==null||Q.classList.toggle("field--hidden",u),u?(b.step="1000",b.placeholder="e.g. 2500000"):c==="gigabytes"?(b.step="1",b.placeholder="e.g. 750"):(b.step="0.1",b.placeholder="e.g. 6.5");const s=b.value.trim(),l=s===""?0:Number.parseFloat(s);if(!Number.isFinite(l)||l<0){_.textContent="Enter a positive number for daily volume.",J();return}_.textContent="";let p=r.averageEventSizeKb>0?r.averageEventSizeKb:Ve;if(!u&&z){const N=z.value.trim(),Z=N===""?p:Number.parseFloat(N);if(!Number.isFinite(Z)||Z<=0){_.textContent="Enter a positive average event size in KB.",J();return}p=Z}let M=l;if(!u){const N=c==="gigabytes"?se:He;M=p>0?l*N/p:0}const{monthlyEvents:S,standardCost:h,realmCost:g,savings:v,savingsPercentage:w,providerRatePerMillion:E,legacyRatePerMillion:I,optimizedRatePerMillion:k,averageOptimization:de,calibrationNote:T}=ot({sources:e,destination:t,dailyTraffic:M});xe.textContent=U(S),ze.textContent=m(Math.max(0,h)),Pe.textContent=m(Math.max(0,g)),Ce.textContent=m(v);const De=`(${m(E)} provider ingest + ${m(B)} legacy tooling per million events)`;R("standardBreakdown",De);const ue=`Realm removes ${m(B)} in legacy tooling, reduces provider ingest by ${(de*100).toFixed(0)}% to ${m(k)} per million events and adds a ${m(ae)} platform fee per million.`,ke=!L&&T?`${ue} ${T}`:ue;R("realmBreakdown",ke);const Ne=p,me=Ft(S,E);j={sources:e,destination:t,trafficUnit:c,organizationSize:o,recommendation:r,dailyInput:l,dailyEvents:M,averageEventSizeKb:Ne,criblCost:me,criblEstimateUnlocked:Ot,monthlyEvents:S,standardCost:h,realmCost:g,savings:v,savingsPercentage:w,providerRatePerMillion:E,legacyRatePerMillion:I,optimizedRatePerMillion:k,averageOptimization:de,calibrationNote:T},ce(!0),At(m(Math.max(0,me))),L&&(L.textContent=T,L.classList.toggle("field--hidden",T===""));const qe=w?`${w>=0?"Savings of":"Increase of"} ${Math.abs(w).toFixed(1)}%`:"No savings at current volume.";R("savingsPercent",qe)},kt=e=>{const i=Y(e.averageEventSizeKb,{maximumFractionDigits:2});if(e.trafficUnit==="events"){const o=e.dailyEvents*e.averageEventSizeKb/se,r=Y(o,{maximumFractionDigits:o>=10?1:2});return`${U(Math.round(e.dailyInput))} events/day (~${r} GB at ${i} KB per event)`}const n=e.trafficUnit==="gigabytes"?"GB":"TB";return`${Y(e.dailyInput,{maximumFractionDigits:2})} ${n} per day (assumes ${i} KB per event)`},Nt=e=>[`Company: ${e.companyName}`,`Primary contact: ${e.contactName}`,`Work email: ${e.contactEmail}`],qt=e=>{const i=e.sources.map(o=>o.label),n=[`Sources (${e.sources.length}): ${i.join(", ")}`,`Destination: ${e.destination.label}`];for(const o of e.sources)o.description&&n.push(`Source notes (${o.label}): ${o.description}`);if(e.destination.description&&n.push(`Destination notes: ${e.destination.description}`),e.sources.length>1){const o=le(e.sources);n.push(`Average provider rate across sources: ${m(o.costPerMillionEvents)} per million events.`,"Scenario assumes evenly distributed volume across selected sources.")}n.push(`Daily volume: ${kt(e)}`,`Converted daily events: ${U(Math.round(e.dailyEvents))}`,`Monthly events modeled: ${U(Math.round(e.monthlyEvents))}`);const t=re(e.recommendation);return n.push(`Realm baseline: ${t}`),n},_t=e=>{const i=Math.abs(e.savingsPercentage),n=e.savings>=0?`Projected savings (monthly): ${m(e.savings)} (${i.toFixed(1)}% vs standard)`:`Projected increase (monthly): ${m(Math.abs(e.savings))} (${i.toFixed(1)}% vs standard)`,t=[`Current cost: ${m(Math.max(0,e.standardCost))}`,`With Realm: ${m(Math.max(0,e.realmCost))}`,n,`Legacy pipeline rate per million: ${m(e.legacyRatePerMillion)} (${m(e.providerRatePerMillion)} provider ingest + ${m(B)} tooling)`,`Blended rate per million (Realm): ${m(e.optimizedRatePerMillion)} + ${m(ae)} platform fee`,`Average optimization applied: ${(e.averageOptimization*100).toFixed(1)}%`],o=e.criblEstimateUnlocked?`Estimated Cribl cost: ${m(Math.max(0,e.criblCost))}`:"Estimated Cribl cost: Unlock with a work email to include this comparison.";return t.push(o),t},Bt=async(e,i)=>{const n=await et();if(!n)throw new Error("jsPDF library is not available.");const t=new n({unit:"pt",format:"letter"}),o=56,r=12,a=16,u=t.internal.pageSize.getWidth()-o*2;let s=o;const l=g=>{const v=t.internal.pageSize.getHeight();s+g>v-o&&(t.addPage(),s=o)},p=await it();if(p){const g=Math.min(180,u),v=Math.min(g,Math.max(1,p.width)),E=(p.width>0?p.height/p.width:.35)*v;l(E+16),t.addImage(p.dataUrl,"PNG",o,s,v,E),s+=E+20}t.setFont("Helvetica","bold"),t.setFontSize(20),t.setTextColor(15,23,42),t.text("Realm Cost Calculator Executive Summary",o,s),s+=28,t.setFont("Helvetica","normal"),t.setFontSize(11),t.setTextColor(100,116,139);const M=new Intl.DateTimeFormat("en-US",{dateStyle:"medium",timeStyle:"short"}).format(new Date);t.text(`Generated on ${M}`,o,s),s+=24,t.setDrawColor(99,102,241),t.setLineWidth(.75),t.line(o,s,o+u,s),s+=24;const S=(g,v)=>{t.setFont("Helvetica","bold"),t.setFontSize(13),t.setTextColor(15,23,42),l(18),t.text(g,o,s),s+=18,t.setFont("Helvetica","normal"),t.setFontSize(11),t.setTextColor(51,65,85);for(const w of v){const E=t.splitTextToSize(w,u);for(const I of E)l(a),t.text(I,o,s),s+=a;s+=4}s+=r};if(S("Stakeholder Details",Nt(i)),S("Scenario Inputs",qt(e)),S("Financial Impact",_t(e)),e.calibrationNote){t.setFont("Helvetica","italic"),t.setFontSize(10),t.setTextColor(100,116,139);const g=t.splitTextToSize(`Calibration note: ${e.calibrationNote}`,u);for(const v of g)l(a),t.text(v,o,s),s+=a;s+=r}const h=t.getNumberOfPages();for(let g=1;g<=h;g+=1){t.setPage(g);const{width:v,height:w}=t.internal.pageSize,E=w-36;t.setFont("Helvetica","normal"),t.setFontSize(10),t.setTextColor(148,163,184),t.text("Realm | https://realm.security",o,E);const I=`Scenario export | Page ${g} of ${h}`,k=t.getTextWidth(I);t.text(I,v-o-k,E)}t.setPage(h),t.save("realm-executive-summary.pdf")},Ut=async e=>{if(!(!j||d.dataset.loading==="true")){d.dataset.loading="true",d.disabled=!0,d.setAttribute("aria-disabled","true"),d.textContent="Preparing PDF...";for(const i of ve)i.disabled=!0;try{await Bt(j,e),d.blur()}catch(i){console.error("PDF export failed:",i),It(Je)}finally{for(const i of ve)i.disabled=!1;d.disabled=!1,d.removeAttribute("aria-disabled"),delete d.dataset.loading,d.classList.contains("metrics__export-button--error")||W()}}},Kt=()=>{const e=Array.from(document.querySelectorAll(".faq__item"));for(const i of e){const n=i.querySelector(".faq__toggle"),t=i.querySelector(".faq__answer");if(!n||!t)continue;const o=r=>{n.setAttribute("aria-expanded",r?"true":"false"),i.classList.toggle("is-open",r),t.hidden=!r};o(!t.hidden),n.addEventListener("click",()=>{const r=n.getAttribute("aria-expanded")==="true";o(!r)}),n.addEventListener("keydown",r=>{r.key==="Escape"&&n.getAttribute("aria-expanded")==="true"&&(r.preventDefault(),o(!1),n.focus())})}},Gt=()=>{var n;ye(x,ne);for(const t of Array.from(x.options))t.selected=!1;x.selectedIndex=-1,Lt(),G((y==null?void 0:y.value)??""),ye(C,Se);const e=document.createElement("option");e.value="",e.textContent="Select a destination",e.disabled=!0,e.selected=!0;const[i]=Array.from(C.options);i?C.insertBefore(e,i):C.appendChild(e),C.value="",Rt(F),Tt(x),H.value="gigabytes",F.value=((n=we[0])==null?void 0:n.id)??F.value,V({overrideTraffic:!0,overrideEventSize:!0}),O()};x.addEventListener("change",()=>{V({overrideEventSize:!D}),O(),G((y==null?void 0:y.value)??"")});C.addEventListener("change",O);F.addEventListener("change",()=>{V({overrideTraffic:!0,overrideEventSize:!0}),O()});b.addEventListener("input",()=>{K=!0,O()});H.addEventListener("change",()=>{V({overrideTraffic:!K,overrideEventSize:!D}),O()});y&&(y.addEventListener("input",()=>{G(y.value)}),y.addEventListener("keydown",e=>{e.key==="Escape"&&y.value!==""&&(y.value="",G(""),y.blur(),e.preventDefault())}));z&&z.addEventListener("input",()=>{D=!0,O()});ge.addEventListener("submit",e=>{if(e.preventDefault(),d.disabled||d.dataset.loading==="true"||!ge.reportValidity())return;const i={companyName:ee.value.trim(),contactName:te.value.trim(),contactEmail:ie.value.trim()};ee.value=i.companyName,te.value=i.contactName,ie.value=i.contactEmail,Ut(i)});Kt();Gt();
