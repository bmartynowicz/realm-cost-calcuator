(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))t(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&t(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function t(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();const ke=new Set(["splunk-es","sumo-logic-siem","microsoft-sentinel","crowdstrike-next-gen-siem"]),ie=[{id:"aws-cloudtrail",label:"AWS - CloudTrail",description:"Account activity events captured across AWS services.",costPerMillionEvents:18,realmOptimization:.35,trafficCategory:"cloud-infrastructure"},{id:"aws-alb-logs",label:"AWS - ALB logs",description:"Application Load Balancer access logs for web traffic analysis.",costPerMillionEvents:16,realmOptimization:.28,trafficCategory:"network-security"},{id:"aws-vpc-flow-logs",label:"AWS - VPC Flow Logs",description:"Network flow records exported from VPC subnets and interfaces.",costPerMillionEvents:14,realmOptimization:.27,trafficCategory:"network-security"},{id:"crowdstrike-falcon",label:"Crowdstrike Falcon",description:"EDR detections, managed threat hunting, and audit events.",costPerMillionEvents:28,realmOptimization:.4,trafficCategory:"endpoint-edr"},{id:"palo-alto-networks-ngfw",label:"Palo Alto Networks - PanOS",description:"Threat, traffic, and URL filtering logs from PAN-OS.",costPerMillionEvents:27,realmOptimization:.6,trafficCategory:"network-security"},{id:"fortinet-fortigate",label:"Fortinet - Fortigate",description:"Unified threat management events from FortiGate appliances.",costPerMillionEvents:23,realmOptimization:.75,trafficCategory:"network-security"},{id:"cisco-umbrella",label:"Cisco Umbrella",description:"DNS-layer security and secure web gateway telemetry.",costPerMillionEvents:20,realmOptimization:.44,trafficCategory:"network-security"},{id:"infoblox-bloxone-ddi",label:"InfoBlox",description:"DNS, DHCP, and IP address management telemetry from BloxOne DDI.",costPerMillionEvents:20,realmOptimization:.71,trafficCategory:"network-security"},{id:"zscaler-internet-access",label:"Zscaler - ZIA",description:"Cloud proxy transactions and threat protection data.",costPerMillionEvents:22,realmOptimization:.34,trafficCategory:"network-security"},{id:"cloudflare-waf",label:"CloudFlare - WAF",description:"Web application firewall events and edge threat intelligence.",costPerMillionEvents:18,realmOptimization:.3,trafficCategory:"network-security"},{id:"okta",label:"Okta",description:"Identity provider system logs and authentication events.",costPerMillionEvents:23,realmOptimization:.38,trafficCategory:"identity"},{id:"google-cloud-audit-logs",label:"Google Cloud - Audit Logs",description:"Admin activity, data access, and system event logging.",costPerMillionEvents:18,realmOptimization:.32,trafficCategory:"cloud-infrastructure"},{id:"azure-monitor",label:"Azure Monitor",description:"Platform activity and diagnostic logs collected via Azure Monitor.",costPerMillionEvents:17,realmOptimization:.3,trafficCategory:"cloud-infrastructure"},{id:"microsoft-defender-endpoint",label:"Microsoft - Defender",description:"Behavioral detections and device telemetry from Defender.",costPerMillionEvents:26,realmOptimization:.38,trafficCategory:"endpoint-edr"},{id:"cisco-secure-firewall",label:"Cisco Secure Firewall (f.k.a. Firepower)",description:"Firewall, intrusion, and malware detection telemetry.",costPerMillionEvents:25,realmOptimization:.35,trafficCategory:"network-security"},{id:"sonicwall-capture-security",label:"SonicWall - SonicOS/X",description:"Firewall and advanced threat protection analytics.",costPerMillionEvents:16,realmOptimization:.25,trafficCategory:"network-security"},{id:"windows-event-logs",label:"Windows Event Logs",description:"Security, system, and application channel events from Windows hosts.",costPerMillionEvents:19,realmOptimization:.42,trafficCategory:"endpoint-edr"},{id:"akamai-security-events",label:"Akamai",description:"Edge security events from Akamai WAF and bot management services.",costPerMillionEvents:21,realmOptimization:.31,trafficCategory:"network-security"},{id:"microsoft-entra-id",label:"Microsoft - Entra ID",description:"Sign-in and audit events from Entra ID tenants.",costPerMillionEvents:19,realmOptimization:.33,trafficCategory:"identity"}],Ne=[{id:"splunk-es",label:"Splunk Enterprise Security",description:"SIEM ingest licensing for Splunk Enterprise Security.",costPerMillionEvents:32,realmOptimization:.36},{id:"microsoft-sentinel",label:"Microsoft Sentinel",description:"Azure-native SIEM with pay-as-you-go log analytics ingestion.",costPerMillionEvents:27,realmOptimization:.34},{id:"crowdstrike-next-gen-siem",label:"CrowdStrike Falcon Next-Gen SIEM",description:"CrowdStrike-managed SIEM/XDR service built on Falcon LogScale with automated response.",costPerMillionEvents:28,realmOptimization:.35},{id:"ibm-qradar",label:"IBM Security QRadar",description:"Event processor capacity sized for mid-market deployments.",costPerMillionEvents:29,realmOptimization:.33},{id:"sumo-logic-siem",label:"Sumo Logic Cloud SIEM",description:"Cloud-native SIEM with continuous analytics ingest tier.",costPerMillionEvents:24,realmOptimization:.31},{id:"google-chronicle",label:"Google Chronicle Security Operations",description:"Planet-scale SIEM with built-in threat intelligence enrichment.",costPerMillionEvents:26,realmOptimization:.35},{id:"exabeam-fusion-siem",label:"Exabeam Fusion SIEM",description:"Behavioral analytics-driven SIEM with UEBA correlation.",costPerMillionEvents:25,realmOptimization:.34},{id:"rapid7-insightidr",label:"Rapid7 InsightIDR",description:"Cloud SIEM with integrated threat detection and response.",costPerMillionEvents:24,realmOptimization:.33},{id:"elastic-security-siem",label:"Elastic Security SIEM",description:"Elastic Stack-based SIEM with detection rules and cases.",costPerMillionEvents:22,realmOptimization:.32},{id:"logrhythm-nextgen",label:"LogRhythm NextGen SIEM",description:"Analytics-centric SIEM and SOAR platform.",costPerMillionEvents:25,realmOptimization:.33},{id:"arcsight-esm",label:"ArcSight Enterprise Security Manager",description:"Micro Focus ArcSight correlation and compliance platform.",costPerMillionEvents:30,realmOptimization:.34},{id:"fortinet-fortisiem",label:"Fortinet FortiSIEM",description:"Hybrid SIEM with integrated performance and security monitoring.",costPerMillionEvents:23,realmOptimization:.31},{id:"rsa-netwitness",label:"RSA NetWitness Platform",description:"Network and endpoint-focused SIEM with threat hunting.",costPerMillionEvents:28,realmOptimization:.34},{id:"att-cybersecurity-usm",label:"AT&T Cybersecurity USM Anywhere",description:"Cloud SIEM with integrated asset discovery and orchestration.",costPerMillionEvents:22,realmOptimization:.3},{id:"securonix-next-gen",label:"Securonix Next-Gen SIEM",description:"Cloud-native SIEM with UEBA and threat content subscriptions.",costPerMillionEvents:27,realmOptimization:.36},{id:"devo-security-operations",label:"Devo Security Operations",description:"High-volume cloud SIEM with real-time analytics.",costPerMillionEvents:25,realmOptimization:.35},{id:"graylog-security-enterprise",label:"Graylog Security Enterprise",description:"Log analytics and SIEM tailored for modern security teams.",costPerMillionEvents:21,realmOptimization:.3},{id:"hunters-soc-platform",label:"Hunters SOC Platform",description:"Cloud-native SIEM with autonomous detection engineering.",costPerMillionEvents:23,realmOptimization:.33},{id:"blumira-siem",label:"Blumira Automated SIEM",description:"Managed SIEM delivering automated detection and response.",costPerMillionEvents:20,realmOptimization:.29},{id:"logpoint-siem",label:"LogPoint SIEM",description:"European-built SIEM with UEBA and SOAR modules.",costPerMillionEvents:22,realmOptimization:.31},{id:"netsurion-eventtracker",label:"Netsurion EventTracker",description:"Co-managed SIEM for distributed enterprises and MSPs.",costPerMillionEvents:21,realmOptimization:.3}],be=Ne.filter(e=>ke.has(e.id)),qe=1024*1024,Ee=[{id:"under-1000-gb",label:"Less than 1,000 employees",optionLabel:"Less than 1,000 employees",shortLabel:"Less than 1,000 employees",defaultDailyGigabytes:750,description:"Ideal for smaller teams where log pipelines rarely exceed a terabyte per day."},{id:"1000-5000-gb",label:"1,000 - 5,000 employees",optionLabel:"1,000 - 5,000 employees",shortLabel:"1,000 - 5,000 employees",defaultDailyGigabytes:3e3,description:"Best fit for mid-size estates that typically ingest one to five terabytes daily."},{id:"over-5000-gb",label:"5,000+ employees",optionLabel:"5,000+ employees",shortLabel:"5,000+ employees",defaultDailyGigabytes:6500,description:"Use this for large enterprises where daily log volume usually tops five terabytes."}],_e=new Map(Ee.map(e=>[e.id,e])),ne="identity",ue={identity:"Identity and workforce access telemetry","cloud-infrastructure":"Cloud platform control-plane and audit activity","network-security":"Network flow, firewall, and secure service edge telemetry","endpoint-edr":"Endpoint detection and response telemetry","saas-business":"SaaS application and collaboration activity"},me={identity:{"under-1000-gb":{averageEventSizeKb:1.2},"1000-5000-gb":{averageEventSizeKb:1.3},"over-5000-gb":{averageEventSizeKb:1.3}},"cloud-infrastructure":{"under-1000-gb":{averageEventSizeKb:1.6},"1000-5000-gb":{averageEventSizeKb:1.7},"over-5000-gb":{averageEventSizeKb:1.8}},"network-security":{"under-1000-gb":{averageEventSizeKb:.12},"1000-5000-gb":{averageEventSizeKb:.13},"over-5000-gb":{averageEventSizeKb:.14}},"endpoint-edr":{"under-1000-gb":{averageEventSizeKb:3.5},"1000-5000-gb":{averageEventSizeKb:3.8},"over-5000-gb":{averageEventSizeKb:4}},"saas-business":{"under-1000-gb":{averageEventSizeKb:1.5},"1000-5000-gb":{averageEventSizeKb:1.6},"over-5000-gb":{averageEventSizeKb:1.7}}},Se=Ee,Be=e=>{const i=_e.get(e);if(!i)throw new Error(`Unknown organization size key: ${e}`);return i},Ue=(e,i)=>{const t=(me[e]??me[ne])[i];if(!t)throw new Error(`Missing baseline for category ${e} and size ${i}`);return t},he=(e,i)=>{const n=Be(i),t=e.trafficCategory??ne,o=Ue(t,i),r=n.defaultDailyGigabytes,s=o.averageEventSizeKb,l=Math.round(r*qe/Math.max(s,1e-4));return{organizationSize:n,category:t,dailyEvents:l,dailyGigabytes:r,averageEventSizeKb:s}},oe=e=>{const{organizationSize:i,category:n,dailyEvents:t,averageEventSizeKb:o,dailyGigabytes:r}=e,s=ue[n]??ue[ne],l=r/1024,u=r>=1024?`${l.toLocaleString(void 0,{maximumFractionDigits:2})} TB`:`${r.toLocaleString(void 0,{maximumFractionDigits:r>=100?0:1})} GB`;return[`${s} baseline for ${i.shortLabel.toLowerCase()}:`,`Approximately ${u} per day (~${t.toLocaleString()} events at ${o.toFixed(1)} KB per event).`].join(" ")},re=7.5,ae=1024*1024,Ke=ae*1024,Ge=1,We=.75,B=12,je=.18,He=12;var ve;(ve=document.querySelector('[data-role="cribl-comparison"]'))==null||ve.remove();const Ve="Download executive summary PDF",Ze="Export unavailable - try again";let Z=null;const Xe=async()=>{var i;if(typeof window>"u")return null;const e=window;return(i=e.jspdf)!=null&&i.jsPDF?e.jspdf.jsPDF:(Z||(Z=new Promise(n=>{const t=document.createElement("script");t.src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js",t.async=!0,t.crossOrigin="anonymous",t.onload=()=>{var r;const o=((r=window.jspdf)==null?void 0:r.jsPDF)??null;n(o)},t.onerror=()=>n(null),document.head.appendChild(t)})),Z)},Ye="Realm-Security-Logo.png";let P;const Qe=async()=>{if(P!==void 0)return P;if(typeof window>"u"||typeof document>"u")return P=null,P;try{const e=await fetch(Ye,{cache:"force-cache"});if(!e.ok)throw new Error(`Realm logo request failed with status ${e.status}`);const i=await e.blob(),n=URL.createObjectURL(i);P=await new Promise((o,r)=>{const s=new Image;s.onload=()=>{try{const l=s.naturalWidth||256,u=s.naturalHeight||90,a=document.createElement("canvas");a.width=l,a.height=u;const c=a.getContext("2d");if(!c){r(new Error("Realm logo canvas context unavailable."));return}c.drawImage(s,0,0,l,u),o({dataUrl:a.toDataURL("image/png"),width:l,height:u})}catch(l){r(l)}finally{URL.revokeObjectURL(n)}},s.onerror=()=>{URL.revokeObjectURL(n),r(new Error("Realm logo image failed to load."))},s.src=n})}catch(e){console.error("Realm logo failed to load for PDF export:",e),P=null}return P},Je={"fortinet-fortigate::sumo-logic-siem":{averageOptimization:.2099,note:"Calibrated to Vensure case study (~$250K annual savings with Realm Focus)."}},m=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:e<100?2:0}).format(e),we=e=>new Intl.NumberFormat("en-US",{maximumFractionDigits:0}).format(e),X=(e,{maximumFractionDigits:i=2,minimumFractionDigits:n}={})=>{const t=typeof n=="number"?n:e%1===0?0:Math.min(2,i);return new Intl.NumberFormat("en-US",{maximumFractionDigits:i,minimumFractionDigits:t}).format(e)},se=e=>{if(e.length===0)throw new Error("At least one source must be provided for calculation.");if(e.length===1){const[n]=e;return{realmOptimization:n.realmOptimization}}return{realmOptimization:e.reduce((n,t)=>(n.realmOptimization+=t.realmOptimization,n),{realmOptimization:0}).realmOptimization/e.length}},et=({sources:e,destination:i,dailyTraffic:n})=>{if(e.length===0)throw new Error("At least one source must be selected.");const t=n/1e6,o=se(e),r=i.costPerMillionEvents,s=r+B,l=t*s,u=e.length===1?`${e[0].id}::${i.id}`:null,a=u?Je[u]:void 0,c=(a==null?void 0:a.averageOptimization)??Math.min(We,(o.realmOptimization+i.realmOptimization)/2),p=r*(1-c),S=t*(p+re),h=l-S,w=l>0?h/l*100:0;return{standardCost:l,realmCost:S,savings:h,savingsPercentage:w,providerRatePerMillion:r,legacyRatePerMillion:s,optimizedRatePerMillion:p,averageOptimization:c,calibrationNote:(a==null?void 0:a.note)??""}},tt=document.querySelector("#sourceSelect"),it=document.querySelector('[data-role="source-search"]'),nt=document.querySelector("#destinationSelect"),ot=document.querySelector("#organizationSize"),rt=document.querySelector("#trafficInput"),at=document.querySelector("#trafficUnit"),st=document.querySelector("#eventSizeInput"),lt=document.querySelector('[data-role="event-size-field"]'),ct=document.querySelector("#sourceSummary"),dt=document.querySelector("#destinationSummary"),ut=document.querySelector("#trafficError"),mt=document.querySelector("#standardCost"),pt=document.querySelector("#realmCost"),ft=document.querySelector("#savings"),gt=document.querySelector("#calibrationNote"),vt=document.querySelector("#trafficRecommendation"),yt=document.querySelector('[data-role="export-pdf-form"]'),bt=document.querySelector("#exportCompanyInput"),Et=document.querySelector("#exportContactInput"),St=document.querySelector("#exportEmailInput"),ht=document.querySelector('[data-role="export-pdf-button"]'),f=(e,i)=>{if(e===null)throw new Error(`${i} element was not found in the document`);return e},z=f(tt,"Source select"),L=f(nt,"Destination select"),R=f(ot,"Organization size select"),b=f(rt,"Traffic input"),j=f(at,"Traffic unit select"),y=it??null,M=st??null,Y=lt??null,wt=f(ct,"Source summary"),q=f(dt,"Destination summary"),_=f(ut,"Traffic error"),xe=f(mt,"Current cost"),ze=f(pt,"Realm cost"),Me=f(ft,"Savings"),$=f(vt,"Traffic recommendation"),pe=f(yt,"Export PDF form"),J=f(bt,"Export company input"),ee=f(Et,"Export contact input"),te=f(St,"Export email input"),d=f(ht,"Export PDF button"),O=gt??null,fe=[J,ee,te];let Ce=[],U=!1,D=!1,A=null;const Pe=e=>e.normalize("NFKD").replace(/[\u0300-\u036f]/gu,"").toLowerCase(),xt=()=>{Ce=Array.from(z.options).map(e=>{const i=ie.find(t=>t.id===e.value),n=Pe(`${e.textContent??""} ${(i==null?void 0:i.description)??""}`);return{option:e,tokens:n}})},K=e=>{const i=Pe(e.trim()),n=i.length>0;for(const t of Ce){const r=!n||t.tokens.includes(i)||t.option.selected;t.option.hidden=!r}n&&(z.scrollTop=0)},Le=new Map;document.querySelectorAll('[data-role="tooltip-text"]').forEach(e=>{e.id&&Le.set(e.id,e)});const Oe=new Map;document.querySelectorAll('[data-role="tooltip-trigger"]').forEach(e=>{var o;const i=e.dataset.tooltipTarget;if(!i)return;Oe.set(i,e);const n=(o=e.dataset.tooltipLabel)==null?void 0:o.trim();n&&e.setAttribute("aria-label",n),e.hasAttribute("aria-expanded")||e.setAttribute("aria-expanded","false");const t=r=>{e.setAttribute("aria-expanded",r?"true":"false")};e.addEventListener("mouseenter",()=>t(!0)),e.addEventListener("mouseleave",()=>t(!1)),e.addEventListener("focus",()=>t(!0)),e.addEventListener("blur",()=>t(!1)),e.addEventListener("keydown",r=>{r.key==="Escape"&&(t(!1),e.blur())})});const F=(e,i)=>{var r,s;const n=i.trim(),t=Le.get(e);t&&(t.textContent=n);const o=Oe.get(e);if(o)if(n){o.hidden=!1,o.dataset.tooltip=n,o.setAttribute("title",n);const l=(r=o.dataset.tooltipLabel)==null?void 0:r.trim();l?o.setAttribute("aria-label",`${l}: ${n}`):o.setAttribute("aria-label",n)}else{o.hidden=!0,delete o.dataset.tooltip,o.removeAttribute("title");const l=(s=o.dataset.tooltipLabel)==null?void 0:s.trim();l?o.setAttribute("aria-label",l):o.removeAttribute("aria-label"),o.setAttribute("aria-expanded","false")}};let zt=!1;var ye;const Ie=((ye=d.textContent)==null?void 0:ye.trim())||Ve;d.textContent=Ie;const G=()=>{d.textContent=Ie,d.classList.remove("metrics__export-button--error"),d.removeAttribute("data-error")},Mt=e=>{d.textContent=e,d.classList.add("metrics__export-button--error"),d.setAttribute("data-error",e),window.setTimeout(()=>{G()},4e3)},le=e=>{d.disabled=!e,e?(G(),d.removeAttribute("aria-disabled")):(d.setAttribute("aria-disabled","true"),G())};le(!1);let W=null;const Ct=e=>{},Pt=(e,i)=>{if(e<=0)return 0;const n=e/1e6,o=(i+He)*(1+je);return n*o},ge=(e,i)=>{e.innerHTML="";for(const n of i){const t=document.createElement("option");t.value=n.id,t.textContent=n.label,e.appendChild(t)}},Lt=e=>{e.innerHTML="";for(const i of Se){const n=document.createElement("option");n.value=i.id,n.textContent=i.optionLabel,n.title=i.description,e.appendChild(n)}},Ae=(e,i)=>{const n=e.find(t=>t.id===i);if(!n)throw new Error(`Unknown endpoint id: ${i}`);return n},Ot=e=>{const i=(e.realmOptimization*100).toFixed(0);return`${e.description} • ~${i}% typical Realm reduction`},It=(e,i)=>{e.textContent=`${i.description} - ${m(i.costPerMillionEvents)} per million events`},At=e=>{e.addEventListener("mousedown",i=>{const n=i.target;if(!(n instanceof HTMLOptionElement))return;i.preventDefault();const t=e.scrollTop;n.selected=!n.selected,e.dispatchEvent(new Event("change",{bubbles:!0})),window.requestAnimationFrame(()=>{e.scrollTop=t,n.hidden?e.focus():n.focus()})})},Rt=()=>Array.from(z.selectedOptions).map(e=>e.value).filter(e=>e!==""),Re=()=>{const e=Rt();return e.length===0?[]:e.map(i=>Ae(ie,i))},Ft=(e,i)=>{if(i.length===0){e.textContent="Select at least one source.",e.removeAttribute("title");return}if(i.length===1){e.textContent=Ot(i[0]),e.title=i[0].label;return}const t=(se(i).realmOptimization*100).toFixed(0);e.textContent=`${i.length} sources selected • Avg Realm reduction ~${t}%`,e.title=i.map(o=>o.label).join(", ")},Q=()=>{W=null,le(!1),xe.textContent="--",ze.textContent="--",Me.textContent="--",F("standardBreakdown",""),F("realmBreakdown",""),F("savingsPercent",""),O&&(O.textContent="",O.classList.add("field--hidden"))},H=({overrideTraffic:e,overrideEventSize:i}={})=>{const n=R.value,t=Re(),o=t[0]??null;if(!o){A=null,$.textContent="Select at least one source to view recommended traffic.";return}const r=he(o,n);A=r;const s=j.value,l=e??(!U||b.value.trim()===""),u=M&&s!=="events"?i??(!D||M.value.trim()===""):!1;if(l){if(s==="events")b.value=Math.round(r.dailyEvents).toString();else if(s==="gigabytes"){const c=r.dailyGigabytes,p=c>=100?0:c>=10?1:2;b.value=Number(c.toFixed(p)).toString()}else{const c=r.dailyGigabytes/1024,p=c>=100?0:c>=10?1:2;b.value=Number(c.toFixed(p)).toString()}U=!1}u&&M&&(M.value=r.averageEventSizeKb.toFixed(1),D=!1);const a=oe(r);$.textContent=t.length>1?`${a} (baseline uses ${o.label}; adjust for additional sources as needed.)`:a},I=()=>{const e=Re(),i=e[0]??null,n=L.value;Ft(wt,e);let t=null;if(n?(t=Ae(be,n),It(q,t),q.title=t.label):(q.textContent="Select a destination.",q.removeAttribute("title")),!i||!t){A=i?A:null,_.textContent="",i?$.textContent="Select a destination to calculate costs.":$.textContent="Select at least one source to view recommended traffic.",Q();return}const o=R.value,r=A??he(i,o);A=r;const s=oe(r);$.textContent=e.length>1?`${s} (baseline uses ${i.label}; adjust for additional sources as needed.)`:s;const l=j.value,u=l==="events";Y==null||Y.classList.toggle("field--hidden",u),u?(b.step="1000",b.placeholder="e.g. 2500000"):l==="gigabytes"?(b.step="1",b.placeholder="e.g. 750"):(b.step="0.1",b.placeholder="e.g. 6.5");const a=b.value.trim(),c=a===""?0:Number.parseFloat(a);if(!Number.isFinite(c)||c<0){_.textContent="Enter a positive number for daily volume.",Q();return}_.textContent="";let p=r.averageEventSizeKb>0?r.averageEventSizeKb:Ge;if(!u&&M){const N=M.value.trim(),V=N===""?p:Number.parseFloat(N);if(!Number.isFinite(V)||V<=0){_.textContent="Enter a positive average event size in KB.",Q();return}p=V}let S=c;if(!u){const N=l==="gigabytes"?ae:Ke;S=p>0?c*N/p:0}const{standardCost:h,realmCost:w,savings:g,savingsPercentage:v,providerRatePerMillion:x,legacyRatePerMillion:E,optimizedRatePerMillion:C,averageOptimization:k,calibrationNote:T}=et({sources:e,destination:t,dailyTraffic:S});xe.textContent=m(Math.max(0,h)),ze.textContent=m(Math.max(0,w)),Me.textContent=m(g);const Fe=`(${m(x)} destination ingest + ${m(B)} legacy tooling per million events)`;F("standardBreakdown",Fe);const ce=`Realm removes ${m(B)} in legacy tooling, reduces destination ingest by ${(k*100).toFixed(0)}% to ${m(C)} per million events and adds a ${m(re)} platform fee per million.`,Te=!O&&T?`${ce} ${T}`:ce;F("realmBreakdown",Te);const $e=p,de=Pt(S,x);W={sources:e,destination:t,trafficUnit:l,organizationSize:o,recommendation:r,dailyInput:c,dailyEvents:S,averageEventSizeKb:$e,criblCost:de,criblEstimateUnlocked:zt,standardCost:h,realmCost:w,savings:g,savingsPercentage:v,providerRatePerMillion:x,legacyRatePerMillion:E,optimizedRatePerMillion:C,averageOptimization:k,calibrationNote:T},le(!0),Ct(m(Math.max(0,de))),O&&(O.textContent=T,O.classList.toggle("field--hidden",T===""));const De=v?`${v>=0?"Savings of":"Increase of"} ${Math.abs(v).toFixed(1)}%`:"No savings at current volume.";F("savingsPercent",De)},Tt=e=>{const i=X(e.averageEventSizeKb,{maximumFractionDigits:2});if(e.trafficUnit==="events"){const o=e.dailyEvents*e.averageEventSizeKb/ae,r=X(o,{maximumFractionDigits:o>=10?1:2});return`${we(Math.round(e.dailyInput))} events/day (~${r} GB at ${i} KB per event)`}const n=e.trafficUnit==="gigabytes"?"GB":"TB";return`${X(e.dailyInput,{maximumFractionDigits:2})} ${n} per day (assumes ${i} KB per event)`},$t=e=>[`Company: ${e.companyName}`,`Primary contact: ${e.contactName}`,`Work email: ${e.contactEmail}`],Dt=e=>{const i=e.sources.map(o=>o.label),n=[`Sources (${e.sources.length}): ${i.join(", ")}`,`Destination: ${e.destination.label}`];for(const o of e.sources)o.description&&n.push(`Source notes (${o.label}): ${o.description}`);if(e.destination.description&&n.push(`Destination notes: ${e.destination.description}`),e.sources.length>1){const o=se(e.sources);n.push(`Average Realm reduction across sources: ${(o.realmOptimization*100).toFixed(0)}% typical.`,"Scenario assumes evenly distributed volume across selected sources.")}n.push(`Daily volume: ${Tt(e)}`,`Converted daily events: ${we(Math.round(e.dailyEvents))}`);const t=oe(e.recommendation);return n.push(`Realm baseline: ${t}`),n},kt=e=>{const i=Math.abs(e.savingsPercentage),n=e.savings>=0?`Projected savings (daily): ${m(e.savings)} (${i.toFixed(1)}% vs standard)`:`Projected increase (daily): ${m(Math.abs(e.savings))} (${i.toFixed(1)}% vs standard)`,t=[`Current cost: ${m(Math.max(0,e.standardCost))}`,`With Realm: ${m(Math.max(0,e.realmCost))}`,n,`Legacy pipeline rate per million: ${m(e.legacyRatePerMillion)} (${m(e.providerRatePerMillion)} destination ingest + ${m(B)} tooling)`,`Blended rate per million (Realm): ${m(e.optimizedRatePerMillion)} + ${m(re)} platform fee`,`Average optimization applied: ${(e.averageOptimization*100).toFixed(1)}%`],o=e.criblEstimateUnlocked?`Estimated Cribl cost: ${m(Math.max(0,e.criblCost))}`:"Estimated Cribl cost: Unlock with a work email to include this comparison.";return t.push(o),t},Nt=async(e,i)=>{const n=await Xe();if(!n)throw new Error("jsPDF library is not available.");const t=new n({unit:"pt",format:"letter"}),o=56,r=12,s=16,u=t.internal.pageSize.getWidth()-o*2;let a=o;const c=g=>{const v=t.internal.pageSize.getHeight();a+g>v-o&&(t.addPage(),a=o)},p=await Qe();if(p){const g=Math.min(180,u),v=Math.min(g,Math.max(1,p.width)),E=(p.width>0?p.height/p.width:.35)*v;c(E+16),t.addImage(p.dataUrl,"PNG",o,a,v,E),a+=E+20}t.setFont("Helvetica","bold"),t.setFontSize(20),t.setTextColor(15,23,42),t.text("Realm Cost Calculator Executive Summary",o,a),a+=28,t.setFont("Helvetica","normal"),t.setFontSize(11),t.setTextColor(100,116,139);const S=new Intl.DateTimeFormat("en-US",{dateStyle:"medium",timeStyle:"short"}).format(new Date);t.text(`Generated on ${S}`,o,a),a+=24,t.setDrawColor(99,102,241),t.setLineWidth(.75),t.line(o,a,o+u,a),a+=24;const h=(g,v)=>{t.setFont("Helvetica","bold"),t.setFontSize(13),t.setTextColor(15,23,42),c(18),t.text(g,o,a),a+=18,t.setFont("Helvetica","normal"),t.setFontSize(11),t.setTextColor(51,65,85);for(const x of v){const E=t.splitTextToSize(x,u);for(const C of E)c(s),t.text(C,o,a),a+=s;a+=4}a+=r};if(h("Stakeholder Details",$t(i)),h("Scenario Inputs",Dt(e)),h("Financial Impact",kt(e)),e.calibrationNote){t.setFont("Helvetica","italic"),t.setFontSize(10),t.setTextColor(100,116,139);const g=t.splitTextToSize(`Calibration note: ${e.calibrationNote}`,u);for(const v of g)c(s),t.text(v,o,a),a+=s;a+=r}const w=t.getNumberOfPages();for(let g=1;g<=w;g+=1){t.setPage(g);const{width:v,height:x}=t.internal.pageSize,E=x-36;t.setFont("Helvetica","normal"),t.setFontSize(10),t.setTextColor(148,163,184),t.text("Realm | https://realm.security",o,E);const C=`Scenario export | Page ${g} of ${w}`,k=t.getTextWidth(C);t.text(C,v-o-k,E)}t.setPage(w),t.save("realm-executive-summary.pdf")},qt=async e=>{if(!(!W||d.dataset.loading==="true")){d.dataset.loading="true",d.disabled=!0,d.setAttribute("aria-disabled","true"),d.textContent="Preparing PDF...";for(const i of fe)i.disabled=!0;try{await Nt(W,e),d.blur()}catch(i){console.error("PDF export failed:",i),Mt(Ze)}finally{for(const i of fe)i.disabled=!1;d.disabled=!1,d.removeAttribute("aria-disabled"),delete d.dataset.loading,d.classList.contains("metrics__export-button--error")||G()}}},_t=()=>{const e=Array.from(document.querySelectorAll(".faq__item"));for(const i of e){const n=i.querySelector(".faq__toggle"),t=i.querySelector(".faq__answer");if(!n||!t)continue;const o=r=>{n.setAttribute("aria-expanded",r?"true":"false"),i.classList.toggle("is-open",r),t.hidden=!r};o(!t.hidden),n.addEventListener("click",()=>{const r=n.getAttribute("aria-expanded")==="true";o(!r)}),n.addEventListener("keydown",r=>{r.key==="Escape"&&n.getAttribute("aria-expanded")==="true"&&(r.preventDefault(),o(!1),n.focus())})}},Bt=()=>{var n;ge(z,ie);for(const t of Array.from(z.options))t.selected=!1;z.selectedIndex=-1,xt(),K((y==null?void 0:y.value)??""),ge(L,be);const e=document.createElement("option");e.value="",e.textContent="Select a destination",e.disabled=!0,e.selected=!0;const[i]=Array.from(L.options);i?L.insertBefore(e,i):L.appendChild(e),L.value="",Lt(R),At(z),j.value="gigabytes",R.value=((n=Se[0])==null?void 0:n.id)??R.value,H({overrideTraffic:!0,overrideEventSize:!0}),I()};z.addEventListener("change",()=>{H({overrideEventSize:!D}),I(),K((y==null?void 0:y.value)??"")});L.addEventListener("change",I);R.addEventListener("change",()=>{H({overrideTraffic:!0,overrideEventSize:!0}),I()});b.addEventListener("input",()=>{U=!0,I()});j.addEventListener("change",()=>{H({overrideTraffic:!U,overrideEventSize:!D}),I()});y&&(y.addEventListener("input",()=>{K(y.value)}),y.addEventListener("keydown",e=>{e.key==="Escape"&&y.value!==""&&(y.value="",K(""),y.blur(),e.preventDefault())}));M&&M.addEventListener("input",()=>{D=!0,I()});pe.addEventListener("submit",e=>{if(e.preventDefault(),d.disabled||d.dataset.loading==="true"||!pe.reportValidity())return;const i={companyName:J.value.trim(),contactName:ee.value.trim(),contactEmail:te.value.trim()};J.value=i.companyName,ee.value=i.contactName,te.value=i.contactEmail,qt(i)});_t();Bt();
